\chapter{Fractional Control}

Fraction-order control, especially fractional-order PID control, is becoming increasingly popular. There are two main topics we will consider: using a controller that has fractional-order derivatives in it and controlling fractional-order systsems. Fractional-order PID is fairly self-evident. Both the I and D terms in the controller may have non-integer order, such that the control input to a system, $u(t)$ is given by
\begin{equation*}
  u(t) = k_p e(t) + k_I \tensor*[_0]\D{^{-\lambda}_t} e(t) + k_I \tensor*[_0]\D{^{\mu}_t} e(t)
\end{equation*}
where $e(t)$ is the error signal. If $\lambda$ and $\mu$ are both one, then this is what we normally would call PID control and if they are not one, it is what we call fractional PID control. 

It makes some sense that since for normal PID control we have the three gains to tune and for fractional PID we have five parameters, the three gains and the two fractional orders, that with more degrees of freedom we can often design a better controller. How to effectively tune five parameters is an issue. Furthermore, a drawback to fractional PID is that the controller needs to either compute or approximate the fractional terms, which can be expensive and therefore slow because they are non local. As such, there has been a lot of effort to determine good appriximations for the fractional controller terms that retain the benefit of fractional PID but are fast to compute.

Controls in general is primarly concerned with stability and performance. We will consider stability first.

\section{Stability of Fractional-Order Transfer Functions}

Many of the topics covered in undergraduate controls courses are ultimately considering stability. For an integer order transfer function
\begin{equation*}
  G(s) = \frac{s^m + a_1 s^{m-1} + \cdots + a_m}{b_0 s^n + b_1 s^{n-1} + \cdots + b_n}
\end{equation*}
solutions will have decaying exponential terms if and only if all the roots of the denominator have negative real part. Many of the usual tools in controls are essentially directed towards that. 
\begin{itemize}
  \item Constructing and analyzing the \emph{Routh array} is a means to determine the number of right half plane poles of the transfer function (but it does not fully factor the characteristic equation).
  \item The \emph{root locus} method is a way to plot how the pole locations of a transfer function change as some parameter in the system changes. It is especially useful when the transfer function is made up of interactions among relatively simple, \ie, factorable, sub-transfer functions with some feedback. Modern computational tools make it not particularly valuable as a means to simply determine the pole locations of a transfer function, \emph{but knowing how poles and zeros affect pole locations in a system provide valuable insighe into design controllers}.
  \item \emph{Bode plots} are a frequency-based tool that can provide insight into stability for a more limited class of systems (non-minimum phase), but are especially useful when a low-order model of a system is difficult to determine from first principles but the input-output behavior is relatively easy to determine experimentally.
  \item \emph{Nyquist plots} are also frequency-based with fewer restrictions than Bode plots.
\end{itemize}
An extremely important point that is always made, but often forgotten because all the work ever given in a controls course automatically satisfy it, is that the class of transfer functions for which such tools work are \emph{rational and proper}. Rational means they are ratios of polynomials (autmatically \emph{not} satisfied in the fractional case) and proper means that the order of the denominator is greater than the numerator.

In order to develop some convenient tools to study stability for fractional-order transfer functions, we first need to understand the asymptotic properties of the Mittag-Leffler functions, \ie, we know that in the integer-order case that poles with positive real parts correspond to terms in the solution with exponentials that increase in time, so what is the generalization of that to $\E_{\alpha,\beta}$?

\begin{theorem}
  For $0 < \alpha < 2$ and all $\beta$, 
  \begin{equation*}
    \lim_{ t \rightarrow \infty} \E_{\alpha,\beta} \left( a t \right) \approx \frac{1}{\alpha} t^{\frac{1-\beta}{\alpha}}\e^{\left( a t \right)^\frac{1}{\alpha}}.
  \end{equation*}
  \label{th:mlfasymptotics}
\end{theorem}

The proof is beyond the scope of this book, but see \cite{fraccontrol,mlfbook}. Here we can check this for a few different cases of $\alpha$, $\beta$ and $a$.

\begin{example}
  \begin{enumerate}
    \item Figure~\ref{fig:mlfasyex1} plots $\E_{1,2}\left(-2 t \right)$ and the corresponding asymptotic expression from Theorem~\ref{th:mlfasymptotics}. 
    \item Figure~\ref{fig:mlfasyex2} plots $\E_{3/2,1/2}\left(-t \right)$ and the corresponding asymptotic expression from Theorem~\ref{th:mlfasymptotics}. 
    \item Figure~\ref{fig:mlfasyex3} plots $\E_{1,2}\left(t \right)$ and the corresponding asymptotic expression from Theorem~\ref{th:mlfasymptotics}. 
  \end{enumerate} 
\end{example}

\begin{figure}  
  \centering
  \subimport{figs/}{mlfasyex1}
  \caption{Mittag-Leffler function $\E_{1,2}\left(-2 t\right)$ (blue) and asymptotic approximation (red).}
  \label{fig:mlfasyex1}
\end{figure}

\begin{figure}  
  \centering
  \subimport{figs/}{mlfasyex2}
  \caption{Mittag-Leffler function $\E_{3/2,1/2}\left(-t\right)$ (blue) and asymptotic approximation (red).}
  \label{fig:mlfasyex2}
\end{figure}

\begin{figure}  
  \centering
  \subimport{figs/}{mlfasyex3}
  \caption{Mittag-Leffler function $\E_{1,2}\left(t\right)$ (blue) and asymptotic approximation (red).}
  \label{fig:mlfasyex3}
\end{figure}

Recall the main Laplace transform table entry for Mittag-Leffler functions:
\begin{equation*}
  \mathcal L \left\{ t^{\beta - 1} \E_{\alpha,\beta} \left( \pm a t^\alpha \right) \right\} = \frac{s^{\beta-\alpha}}{s^\alpha \mp a}.
\end{equation*}
The thing to note here is that the denominator term, $s^\alpha + a$ plays a very similar role as the integer-order poles we are used to considering. In other words, by inspection we can tell that a denominator $s-3$ corresponds to an unstable component of the solution and $s+2$ corresponds to a stable one. Theorem~\ref{th:mlfasymptotics} essentially verifies the same thing for a denominator term like $s^{1/2}+2$ in the fractional case as long as $0 < \alpha < 2$.

\begin{definition}
  A fractional transfer function is of the form
  \begin{equation*}
    G(s) = \frac{\sum_{k=1}^m b_k s^{\beta_k}}{\sum_{k=1}^n a_k s^{\alpha_k}}
  \end{equation*}
  where the $\alpha_k \geq 0$ are called the denominator orders and correspodingly the $\beta_k \geq 0$ are the numerator orders. 
  Often we will normalize it by requiring one of the coefficients to be zero, say $a_1=0$. 
  \label{def:fractionalxf}
\end{definition}

\subsection{Commensurable Transfer Functions}
A particularly convenient situation arises in the case of \emph{commensurable transfer functions}.

\begin{definition}
  A transfer function is said to be commensurable when all the orders $\alpha_k$ and $\beta_k$ are integer multiples of a common divisor $a > 0$. In that case the transfer function is rational in $s^a$. If we let $\lambda = s^a$ then
  \begin{equation*}
    G(s) = \frac{\sum_{k=1}^m b_k s^{\beta_k}}{\sum_{k=1}^n a_k s^{\alpha_k}} = \frac{\sum_{k=0}^m b_k s^{a k}}{\sum_{k=0}^n a_k s^{a k}} = 
    \frac{\sum_{k=0}^m b_k \lambda^{k}}{\sum_{k=0}^n a_k \lambda^{k}}.
  \end{equation*}
  Of course, if all the coefficients of the numerator and denominatore are integer multiples of $a$, they will also be integer multipes of $a/2$, so it is convenient to chose the largest $a$. 
  \label{def:commensurable}
\end{definition}

\begin{example}
  The transfer function
  \begin{equation*}
    G(s) = \frac{s + 3 s^\frac{1}{2} + 5}{s^2 + 2 s^\frac{3}{2} + s^\frac{1}{2} + 2}
  \end{equation*}
  is commensurable with $a = 1/2$ because if we let $\lambda = 1/2$
  \begin{equation*}
    G(s) = \frac{\lambda^2 + 3 \lambda + 5}{\lambda^4 + 2 \lambda^3 + \lambda + 2}.
  \end{equation*}
\end{example}

Stability of commensurable transfer functions has a transparent extension to integer-order transfer functions, but we first need to characterize the idea of left- and right-half planes slightly differently. Another way to say that all the poles of an integer-order transfer function must be in the left half of the complex plane is to require that the absolute value of the angle of the poles (as complex numbers) is greater than $\pi/2$, or more formally, we have the following theorem.

\begin{theorem}
  The commensurable transfer function
  \begin{equation*}
    G(s) =  \frac{\sum_{k=1}^m b_k s^{a k}}{\sum_{k=1}^n a_k s^{a k}} = 
    \frac{\sum_{k=1}^m b_k \lambda^{k}}{\sum_{k=1}^n a_k \lambda^{k}}
  \end{equation*}
  is stable if the solutions to $a_n \lambda^n + a_{n-1} \lambda^{n-1} + \cdots + a_0 = 0$, denoted by $\lambda_k$ are such that
  \begin{equation*}
    \left| \angle \lambda_k \right| > a \frac{\pi}{2}.
  \end{equation*}
  \label{th:commensurablestability}
\end{theorem}

\begin{proof}
  (for now follows very closely what is in \cite{fraccontrol}).

  If there are no repeated roots, then $G(s)$ can be written as the usual sort of partial fraction expansion
  \begin{equation*}
    G(s) = \sum_{k=1}^n \frac{\rho_k}{\lambda - \lambda_k} =  \sum_{k=1}^n \frac{\rho_k}{s^\alpha - \lambda_k}
  \end{equation*}
  so the impulse response will be of the form
  \begin{equation*}
    x(t) = \sum_{k=1}^n \rho_k t^{\alpha-1} \E_{\alpha,\alpha} \left( \lambda_k t^\alpha \right).
  \end{equation*}
  The asymptotic behavior of the solution is, as $t \rightarrow +\infty$
  \begin{equation*}
    x(t) \approx \sum_{k=1}^n \rho_k t^{\alpha-1} \frac{1}{\alpha} \left( \lambda_k t^\alpha \right)^\frac{1-\alpha}{\alpha} \e^{\left( \lambda_k t^\alpha \right)^\frac{1}{\alpha}} = \sum_{k=1}^n \frac{\rho_k}{\alpha}\lambda^{\frac{1-\alpha}{\alpha}}\e^{t \lambda_k^\frac{1}{\alpha}}.
  \end{equation*}
  This will be stable as long as the real part of $\lambda_k^{1/\alpha} < 0$. Since
  \begin{align*}
    \lambda_k^{1/\alpha} &= \left[ \left| \lambda_k \right| \left( \cos \angle \lambda_k + \iu \sin \angle \lambda_k \right) \right]^{1/\alpha} \\
    &= \left| \lambda_k \right|^{1/\alpha} \left( \cos \frac{\angle \lambda_k}{\alpha} + \iu \sin \frac{\angle \lambda_k}{\alpha} \right).
  \end{align*}
  The cosine term will be negative when its argument is greater than $\pi/2$, so we have
  \begin{equation*}
    \frac{\angle \lambda_k}{a} > \frac{\pi}{2}
  \end{equation*}
  or
  \begin{equation*}
    \angle \lambda_k > a \frac{\pi}{2}.
  \end{equation*}
  which is the desired result.
\end{proof}

\begin{remark}
  In the integer order case, $a = 1$ and the angle condition is the same as requiring all the poles to be in the left half plane.
\end{remark}

Consider the following program that uses the Gr\"unwald-Letnikov numerical approximation to numerically compute the solution to
\begin{equation*}
  \frac{\d x}{\d t}(t) + a \frac{d^\frac{1}{2} x}{\d t^\frac{1}{2}}(t) + b x(t) = 1
\end{equation*}
assuming all initial conditions of all orders are zero. Note that the \texttt{bincoeff()} function uses the \texttt{gammaln()} function to extend the domain over which it returns a non-zero value. We will use this program to compute numerical step responses for the next couple examples.
\lstset{numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=5pt}
\lstinputlisting[language=matlab]{step.m}

\begin{example}
  Is the solution
  \begin{equation*}
  	\frac{\d x}{\d t}(t) -2  \frac{d^\frac{1}{2} x}{\d t^\frac{1}{2}}(t) + 5 x(t) = 1
  \end{equation*}
  where all initial conditions of all orders are zero stable?

  Since all initial conditions are zero, the Laplace transform of the equation is the same if we use the Riemann-Liouville or Caputo fractional derivatives, and we get
  \begin{equation*}
    X(s) = \frac{1}{s - 2 s^\frac{1}{2} + 5}.
  \end{equation*}
  This transfer function is commensurate of order $a = 1/2$ and will be stable of all roots of
  \begin{equation*}
    \lambda^2 - 2 \lambda + 5 = 0
  \end{equation*}
   are such that $\left| \angle \lambda_i \right| > \frac{1}{2} \frac{\pi}{2}$.  In this case $\lambda = 1 \pm 2 \iu$ which has an angle greater than $45^\circ$, so the system is stable. 

	A numerically-computed solution is in Figure~\ref{fig:comstableex1}.
	\label{ex:comstableex1}
\end{example}

\begin{figure}
  \centering
  \subimport{figs/}{comstableex1}
  \caption{Step response for Example~\ref{ex:comstableex1}.}
  \label{fig:comstableex1}
\end{figure}

\begin{example}
  Is the solution
  \begin{equation*}
  	\frac{\d x}{\d t}(t) -4  \frac{d^\frac{1}{2} x}{\d t^\frac{1}{2}}(t) + 5 x(t) = 1
  \end{equation*}
  where all initial conditions of all orders are zero stable?

  Since all initial conditions are zero, the Laplace transform of the equation is the same if we use the Riemann-Liouville or Caputo fractional derivatives, and we get
  \begin{equation*}
    X(s) = \frac{1}{s - 4 s^\frac{1}{2} + 5}.
  \end{equation*}
  This transfer function is commensurate of order $a = 1/2$ and will be stable of all roots of
  \begin{equation*}
    \lambda^2 - 4 \lambda + 5 = 0
  \end{equation*}
   are such that $\left| \angle \lambda_i \right| > \frac{1}{2} \frac{\pi}{2}$.  In this case $\lambda = 2 \pm  \iu$ which has an angle less than $45^\circ$, so the system is unstable. 

	A numerically-computed solution is in Figure~\ref{fig:comstableex2}.
	\label{ex:comstableex2}
\end{example}

\begin{figure}
  \centering
  \subimport{figs/}{comstableex2}
  \caption{Step response for Example~\ref{ex:comstableex2}.}
  \label{fig:comstableex2}
\end{figure}

